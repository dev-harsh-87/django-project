<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
{##}
</head>
<body class="bg-gray-100 font-sans">

    <!-- Navbar -->
    <nav class="bg-blue-600 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold">My Recipe Dashboard</h1>
            <div>
                <a href="{% url 'home' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Home</a>
                <a href="{% url 'recipes' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Recipes</a>
                <a href="{% url 'students' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Student</a>
                {% if user.is_authenticated %}
              <a href="{% url 'profile' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Profile</a>
                <a href="{% url 'logout' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Logout</a>
                {% else %}

                <a href="{% url 'login' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Login</a>
                <a href="{% url 'register' %}" class="px-4 py-2 hover:bg-blue-700 rounded">Register</a>
                {% endif %}

            </div>
        </div>
    </nav>

    <div class="container mx-auto mt-8">

        <!-- Welcome Card with button -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 flex flex-col md:flex-row items-center justify-between">
            <div class="mb-4 md:mb-0">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Welcome to Your Recipe Dashboard üç≥</h2>
                <p class="text-gray-600">View, add, and manage your delicious recipes easily.</p>
            </div>
            <div>
                <button id="toggleFormBtn"
                        class="inline-block bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">
                    Add Recipe
                </button>
            </div>
        </div>

        <!-- Add Recipe Form (hidden by default) -->
        <div id="recipeForm" class="bg-white w-full max-w-lg mx-auto p-8 rounded-2xl shadow-lg mb-10 hidden">
            {% if messages %}
                <div class="mb-4">
                    {% for message in messages %}
                        <div class="px-4 py-3 rounded-lg mb-2 text-white
                                    {% if message.tags == 'error' %}bg-red-500{% elif message.tags == 'success' %}bg-green-500{% else %}bg-blue-500{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Add a New Recipe</h2>
            <form method="POST" enctype="multipart/form-data" id="addRecipeForm">
                {% csrf_token %}
                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">Recipe Name</label>
                    <input type="text" name="recipe_name" placeholder="Enter recipe name" required
                           class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">Recipe Description</label>
                    <textarea name="recipe_description" rows="4" placeholder="Write recipe details..." required
                              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none"></textarea>
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 font-medium mb-2">Recipe Image</label>
                    <input type="file" name="recipe_image" required
                           class="w-full text-gray-600 file:mr-4 file:py-2 file:px-4
                                  file:rounded-lg file:border-0
                                  file:text-sm file:font-semibold
                                  file:bg-indigo-600 file:text-white
                                  hover:file:bg-indigo-700">
                </div>

                <button type="submit"
                        class="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition">
                    Save Recipe
                </button>
            </form>
        </div>

        <!-- Saved Recipes Table -->
        <div class="bg-white p-6 rounded-2xl shadow-lg">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold text-gray-800">Saved Recipes</h3>
                <form method="GET" action="" class="flex">
                    <input type="text" name="search_text" placeholder="Search recipes..."
                           class="px-4 py-2 border rounded-l-lg focus:outline-none text-sm">
                    <button type="submit"
                            class="px-4 py-2 bg-indigo-600 text-white rounded-r-lg hover:bg-indigo-700 transition text-sm">
                        Search
                    </button>
                </form>
            </div>

            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200">
                    <thead>
                        <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 text-left">#</th>
                            <th class="py-3 px-6 text-left">Image</th>
                            <th class="py-3 px-6 text-left">Name</th>
                            <th class="py-3 px-6 text-left">Description</th>
                            <th class="py-3 px-6 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-700 text-sm">
                        {% for recipe in recipeData %}
                        <tr class="border-b border-gray-200 hover:bg-gray-50">
                            <td class="py-3 px-6">{{ forloop.counter }}</td>
                            <td class="py-3 px-6">
                                <img src="{{ recipe.recipe_image.url }}" alt="{{ recipe.recipe_name }}"
                                     class="h-12 w-12 object-cover rounded">
                            </td>
                            <td class="py-3 px-6 font-medium">{{ recipe.recipe_name }}</td>
                            <td class="py-3 px-6">{{ recipe.recipe_description|truncatewords:10 }}</td>
                            <td class="py-3 px-6 text-center">
                                <a href="recipe_edit/{{ recipe.id }}" class="text-indigo-600 hover:underline mr-4">Edit</a>
                                <a href="recipe_delete/{{ recipe.id }}" class="text-red-600 hover:underline">Delete</a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="text-center py-4 text-gray-500">No recipes added yet.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-gray-200 text-gray-700 mt-8 py-4 text-center">
        &copy; 2025 My Recipe Dashboard. All rights reserved.
    </footer>

    <!-- JS for toggling form -->
    <script>
        const toggleBtn = document.getElementById('toggleFormBtn');
        const recipeForm = document.getElementById('recipeForm');
        const addForm = document.getElementById('addRecipeForm');

        toggleBtn.addEventListener('click', () => {
            recipeForm.classList.toggle('hidden');
        });

        // Optionally hide form after submit
        addForm.addEventListener('submit', () => {
            recipeForm.classList.add('hidden');
        });
    </script>

</body>
</html>
